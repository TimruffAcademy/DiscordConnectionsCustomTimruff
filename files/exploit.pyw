import sys
import os
import requests
import random
import emoji
from PyQt5 import QtCore, QtGui, QtWidgets, uic
from PyQt5.QtWidgets import QWidget, QPushButton, QMessageBox



qtcreator_file  = "mainwindow.ui"
Ui_MainWindow, QtBaseClass = uic.loadUiType(qtcreator_file)


class MyWindow(QtWidgets.QMainWindow, Ui_MainWindow):
    def __init__(self):
        QtWidgets.QMainWindow.__init__(self)
        Ui_MainWindow.__init__(self)
        self.setupUi(self)
        self.typeSelect.addItems(["Skype","Battlenet","League of Legends", "DiscordTEST"])
        self.setWindowFlags(QtCore.Qt.WindowCloseButtonHint | QtCore.Qt.WindowMinimizeButtonHint)
        self.setFixedSize(self.size())
        self.submitBtn.clicked.connect(self.submit)

    def submit(self):
        text = self.textInput.text()
        token = str(self.tokenInput.text()).strip()
        randNum = random.randrange(10000, 99999)
        self.textInput.setText("")
        typeText = str(self.typeSelect.currentText()).lower().replace(" ", "")

        print(token)
 
        url = f"https://discordapp.com/api/v6/users/@me/connections/{typeText}/{random.randrange(10000,99999)}"
        payload = "{\"name\": \"" + text + "\",\n\"visibility\": 1\n}".encode('utf-8').decode('latin-1')
        headers = {
        'authorization': token,
        'accept-encoding': "gzip, deflate, br",
        'accept-language': "en-US",
        'user-agent': "Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) discord/0.0.305 Chrome/69.0.3497.128 Electron/4.0.8 Safari/537.36",
        'accept': "*/*",
        'authority': "discordapp.com",
        'Content-Type': "application/json",
        'Cache-Control': "no-cache",
        'Host': "discordapp.com",
        'Connection': "keep-alive",
        'cache-control': "no-cache"
        }
     
        response = requests.request("PUT", url, data=payload, headers=headers)




if __name__ == "__main__":
    app = QtWidgets.QApplication(sys.argv)
    window = MyWindow()
    window.show()
    sys.exit(app.exec_())
